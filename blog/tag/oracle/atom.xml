<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Oracle | Programming Design Notes]]></title>
  <link href="http://pro.ctlok.com/blog/tag/oracle/atom.xml" rel="self"/>
  <link href="http://pro.ctlok.com/"/>
  <updated>2012-03-30T16:02:20+08:00</updated>
  <id>http://pro.ctlok.com/</id>
  <author>
    <name><![CDATA[Lawrence Cheung]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Oracle Stored Function]]></title>
    <link href="http://pro.ctlok.com/2010/06/oracle-stored-function.html"/>
    <updated>2010-06-18T00:14:00+08:00</updated>
    <id>http://pro.ctlok.com/2010/06/oracle-stored-function</id>
    <content type="html"><![CDATA[<p>Oracle Stored Function 和 Oracle Stored Procedure 很相似，而 Oracle Stored Function 是必須返回一個數值的，而 Oracle Stored Procedure 則不能返回數值。<br /><br />Oracle Function 格式如下:<br /><pre class="brush: sql">CREATE OR REPLACE <br />FUNCTION FUNCTION_NAME(<br />  args1 NUMBER,<br />  args2 VARCHAR2 ) RETURN VARCHAR2 <br />AS<br />  localVar1 NUMBER := 300;<br />  localVar2 VARCHAR2(20) := 'Hello World';<br />BEGIN<br />  DBMS_OUTPUT.PUT_LINE('args1: ' || args1 || ' args2: ' || args2 || ' localVar1: ' || localVar1 || ' localVar2: ' || localVar2);<br />  RETURN localVar2;<br />END FUNCTION_NAME;<br /></pre><br />其中的 args1 和 args2 是使用這個 Stored Function 時要傳入的變數。<br />而 RETURN VARCHAR2 是指明 Stored Function 會返回的數值型態。<br /><br />使用方法:<br /><pre class="brush: sql">DECLARE<br />  x VARCHAR2(20);<br />BEGIN<br />  x := FUNCTION_NAME(100, 'Hello World');<br />  DBMS_OUTPUT.PUT_LINE(x);<br />END;<br /></pre><br />亦可以預先設定 args 的數值，沒傳入數值則用預設。<br /><pre class="brush: sql">CREATE OR REPLACE <br />PROCEDURE procedure_name(<br />  args1 NUMBER := 100,<br />  args2 VARCHAR2(20) := 'Hello World' )<br /></pre><br />使用方法:<br /><pre class="brush: sql">DECLARE<br />  x VARCHAR2(20);<br />BEGIN<br />  x := procedure_name();<br />  DBMS_OUTPUT.PUT_LINE(x);<br /><br />  x := procedure_name(150);<br />  DBMS_OUTPUT.PUT_LINE(x);<br /><br />  x:= procedure_name(200, 'lawpronotes');<br />  DBMS_OUTPUT.PUT_LINE(x);<br />END;<br /></pre><br />如果 Stored Function 無需傳入數值可以不使用 ()<br />即是像以下這樣:<br /><pre class="brush: sql">CREATE OR REPLACE <br />FUNCTION FUNCTION_NAME RETURN VARCHAR2 <br />AS<br /></pre><br />相關書籍: <a href="http://www.amazon.com/Oracle-PL-SQL-Programming-Versions/dp/0596514468?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle PL/SQL Programming: Covers Versions Through Oracle Database 11g Release 2 (Animal Guide)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0596514468&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0596514468" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Oracle-Database-Programming-Osborne-ORACLE/dp/0071494456?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle Database 11g PL/SQL Programming (Osborne ORACLE Press Series)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0071494456&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0071494456" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Oracle-PL-SQL-Best-Practices/dp/0596514107?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle PL/SQL Best Practices" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0596514107&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0596514107" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-3276168274847841374?l=lawpronotes.blogspot.com' alt='' /></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Oracle Forms Builder + IE 8]]></title>
    <link href="http://pro.ctlok.com/2010/05/oracle-forms-builder-ie-8.html"/>
    <updated>2010-05-28T12:17:00+08:00</updated>
    <id>http://pro.ctlok.com/2010/05/oracle-forms-builder-ie-8</id>
    <content type="html"><![CDATA[<p>安裝好 Forms Builder 後使用 IE 8 打開時會提示安裝 Oracle JInitiator，可在這裡下載最新版本: <a href="http://www.oracle.com/technology/software/products/developer/htdocs/jinit.htm">Oracle JInitiator</a><br /><br />安裝完成後再次使用 IE 8 開啟，IE 8 會沒有反應。<br />解決方法是使用 Java 的 jvm.dll 而不使用 JInitiator 的 jvm.dll，將<br />C:\Program Files\Java\jre6\bin\client\jvm.dll 複製到<br />C:\Program Files\Oracle\JInitiator 1.x.x.x\bin\hotspot (記得將 jvm.dll 備份)<br /><br />然後到開啟 IE 並修改設定:<br /><ol><li>工具 -&gt; 網際網路選項 -&gt; 安全性 -&gt; 自訂 -&gt; 停用 XSS 篩選器</li><li>工具 -&gt; 網際網路選項&nbsp;-&gt; 進階 -&gt; 不要選取 "啟用記憶體保護以拹助防止網路攻擊"</li></ol><div>如果用了以上的方法還是有問題，可下載這個&nbsp;<a href="http://sites.google.com/site/lawrencespace/lawpronotes/download/jvm.zip">jvm.zip</a>&nbsp;放到&nbsp;:\Program Files\Oracle\JInitiator 1.x.x.x\bin\hotspot 下。</div><div><br /></div><div>現在應該沒有問題的了。</div><div><br /></div><div><a href="http://www.amazon.com/Oracle-Forms-Interactive-Workbook-Motivala/dp/0130158089?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle Forms Interactive Workbook" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0130158089&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0130158089" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Oracle-Developer-Advanced-Forms-Reports/dp/0072120487?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle Developer Advanced Forms and Reports" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0072120487&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0072120487" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Oracle-Developer-Techniques-Bulusu-Lakshman/dp/0672318466?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle Developer Forms Techniques" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0672318466&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0672318466" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /></div><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-9155037019807592498?l=lawpronotes.blogspot.com' alt='' /></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Oracle Stored Procedure]]></title>
    <link href="http://pro.ctlok.com/2010/04/oracle-stored-procedure.html"/>
    <updated>2010-04-25T22:47:00+08:00</updated>
    <id>http://pro.ctlok.com/2010/04/oracle-stored-procedure</id>
    <content type="html"><![CDATA[<p>Oracle Stored Procedure 是可以重覆使用的程序，和 Oracle Stored Function 不同的是 Oracle Stored Procedure 不能返回數值。我們可以將一些重覆性的步驟預先寫到 Procedure 中。<br /><br />Oracle Stored Procedure 格式如下:<br /><pre class="brush: sql">CREATE OR REPLACE <br />PROCEDURE PROCEDURE_NAME(<br />  args1 NUMBER,<br />  args2 VARCHAR2(20) )<br />AS<br />  localVar1 NUMBER := 300;<br />  localVar2 VARCHAR(20) := 'Hello World';<br />BEGIN<br />  DBMS_OUTPUT.PUT_LINE('args1: ' || args1 || ' args2: ' || args2 || ' localVar1: ' || localVar1 || ' localVar2: ' || localVar2);<br />END PROCEDURE_NAME;<br /></pre><br />CREATE OR REPLACE PROCEDURE procedure_name 是 Stored Procedure 的開始。<br /><br />其中的 args1 和 args2 是使用這個 Stored Procedure 時要傳入的變數。<br />使用方法:<br /><pre class="brush: sql">BEGIN<br />  PROCEDURE_NAME(100, 'Hello World');<br />END;<br /></pre><br />亦可以預先設定 args 的數值。<br /><pre class="brush: sql">CREATE OR REPLACE <br />PROCEDURE PROCEDURE_NAME(<br />  args1 NUMBER := 100,<br />  args2 VARCHAR2(20) := 'Hello World' )<br /></pre><br />使用方法:<br /><pre class="brush: sql">BEGIN<br />  PROCEDURE_NAME();<br />  PROCEDURE_NAME(150);<br />  PROCEDURE_NAME(200, 'lawpronotes');<br />END;<br /></pre><br />這樣變成不傳入變數時便使用預設的數值。<br /><br />如果 Stored Procedure 無需傳入數值可以不使用 ()<br />即是像以下這樣:<br /><pre class="brush: sql">CREATE OR REPLACE <br />PROCEDURE PROCEDURE_NAME<br />AS<br /></pre><br />而 AS 和 BEGIN 中間的部分是用來定義內部變數的位置，即是 localVar1 和 localVar2。<br /><br />BEGIN 和 END procedure_name; 中間的部分是 Stored Procedure 的主體，是寫 PL/SQL 的地方，DBMS_OUTPUT.PUT_LINE() 是系統的 function，作用是將資料打印在 console 上，在這裡我將所有變數數值打印出來。<br /><br />而 PL/SQL 用 || 將字串連接起來，作用就好像 Java 的 + 。<br /><br />最後使用 END PROCEDURE_NAME; 表示 Stored Procedure 完結。<br /><br />相關書籍: <a href="http://www.amazon.com/Oracle-PL-SQL-Programming-Versions/dp/0596514468?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle PL/SQL Programming: Covers Versions Through Oracle Database 11g Release 2 (Animal Guide)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0596514468&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0596514468" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Beginning-PL-SQL-Novice-Professional/dp/1590598822?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Beginning PL/SQL: From Novice to Professional" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=1590598822&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=1590598822" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Oracle-Database-Programming-Osborne-ORACLE/dp/0071494456?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Oracle Database 11g PL/SQL Programming (Osborne ORACLE Press Series)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0071494456&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0071494456" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-603485238728640715?l=lawpronotes.blogspot.com' alt='' /></div></p>
]]></content>
  </entry>
  
</feed>
