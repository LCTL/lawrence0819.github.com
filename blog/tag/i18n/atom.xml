<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: I18N | Programming Design Notes]]></title>
  <link href="http://lawrence0819.github.com/blog/tag/i18n/atom.xml" rel="self"/>
  <link href="http://lawrence0819.github.com/"/>
  <updated>2012-03-25T11:22:02+08:00</updated>
  <id>http://lawrence0819.github.com/</id>
  <author>
    <name><![CDATA[Lawrence Cheung]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[PHP CodeIgniter 根據瀏覽器語言來顯示語言]]></title>
    <link href="http://lawrence0819.github.com/2011/12/php-codeigniter-i18n-browser-locale.html"/>
    <updated>2011-12-18T16:48:00+08:00</updated>
    <id>http://lawrence0819.github.com/2011/12/php-codeigniter-i18n-browser-locale</id>
    <content type="html"><![CDATA[<p><a href="http://smashingweb.ge6.org/wp-content/uploads/2009/08/codeigniter-lg.gif" imageanchor="1" style=""><img border="0" height="200" width="200" src="http://smashingweb.ge6.org/wp-content/uploads/2009/08/codeigniter-lg.gif" /></a><br /><br /><br />近排為客戶製作一個網頁，因為客戶已經買下了虛擬主機空間，不能用 <b>Java</b> 去作 <b>Server side language</b>，只好使用 <b>PHP + CodeIgniter</b>。他要求有轉換語言的功能，但發覺 <b>CodeIgniter</b> 本身的 <b>i18n</b> 功能不太完善，只好自己製作一個。<br /><br />這個 <b>i18n</b> 有點像 <b>JSF</b> 的<b>i18n</b> 功能，是根據用戶的瀏覽器語言來判定顯示那一種語言，並且對 <b>Controller</b> 控制語言的程式碼減少(可以 1 行程式碼也不用寫就能夠自動設換各種語言)。這可以減少重複的程式碼和減低 <b>Controller</b> 的複雜性。<br /><br />我己經將這個 <b>Library</b> 放上 <b>github</b> 了，有興趣可以下載來試試 <a href="https://github.com/lawrence0819/php-ci-internationalization">https://github.com/lawrence0819/php-ci-internationalization</a>。<br /><br />以下就是 <b>I18n.php (Core)</b>，放到 <b>application/libraries/I18n.php</b>。<br /><pre class="brush:php">&lt;?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');<br /><br />/<strong><br /> * I18n class<br /> <em><br /> * @package     CodeIgniter<br /> * @subpackage  Libraries<br /> * @category    Libraries<br /> * @author      Lawrence Cheung<br /> * @version     1.0<br /> * @link        https://github.com/lawrence0819<br /> </em>/<br />class I18n{<br />    <br />    protected $CI;<br />    protected $auto = TRUE;<br />    protected $loaded = FALSE;<br />    protected $locale;<br />    <br />    /</strong><br />     * Constructor - get CI instance<br />     <em><br />     </em>/<br />    public function <strong>construct(){<br />        $this -&gt; CI = get_instance(); <br />    }<br />    <br />    /<strong><br />     * Auto load language for CI HOOK<br />     <em><br />     * @access  public<br />     * @return  void<br />     </em>/<br />    public function auto_load_language(){<br />        if ($this -&gt; auto){<br />            $this -&gt; load_language();<br />        }<br />    }<br />    <br />    /</strong><br />     * Manual load language file<br />     <em><br />     * @access  public<br />     * @return  void<br />     </em>/<br />    public function load_language() {<br />        $lang = $this -&gt; get_current_locale();<br />        $language = $this -&gt; get_language_config();<br />        <br />        if (!$this -&gt; loaded) {<br />            $files = $language['files'];<br />            $locale = $language['locale'];<br /><br />            if (array_key_exists($lang, $locale)) {<br />                $folder = $locale[$lang];<br />            } else {<br />                $shortLang = substr($lang, 0, 2);<br />                if (array_key_exists($shortLang, $locale)) {<br />                    $folder = $locale[$shortLang];<br />                } else {<br />                    $folder = $locale['default'];<br />                }<br />            }<br /><br />            foreach ($files as $file) {<br />                $this -&gt; CI -&gt; lang -&gt; load($file, $folder);<br />            }<br />            <br />            $this -&gt; loaded = TRUE;<br />        }<br />    }<br />    <br />    /<strong><br />     * Prevent CI Hook to auto load language file<br />     <em><br />     * @access  public<br />     * @return  void<br />     </em>/<br />    public function prevent_auto(){<br />        $this -&gt; auto = FALSE;<br />    }<br />    <br />    /</strong><br />     * Set current user locale and save locale to cookies<br />     <em><br />     * @access  public<br />     * @Param   string      the locale string: en-US, en-UK, zh-TW, zh-CN<br />     * @Param   integer     the cookies value expire time, default is 30 day<br />     * @Param   string      cookies key<br />     * @return  void<br />     </em>/<br />    public function set_current_locale($locale, $expire = 259200, $cookie_key = 'locale') {<br />        setcookie($cookie_key, $locale, time() + $expire);<br />        $this -&gt; locale = $locale;<br />    }<br />    <br />    /<strong><br />     * Get current user locale<br />     <em><br />     * @access  public<br />     * @Param   string      cookies key, if you changed the key at set_current_locale, please assign it<br />     * @return  string<br />     </em>/<br />    public function get_current_locale($cookie_key = 'locale') {<br />        if (!$this -&gt; locale){<br />            if (isset($<em>COOKIE[$cookie_key])) {<br />                $lang = $</em>COOKIE[$cookie_key];<br />            } else {<br />                if (isset($<em>SERVER['HTTP_ACCEPT_LANGUAGE'])) {<br />                    $lang = substr($</em>SERVER['HTTP_ACCEPT_LANGUAGE'], 0, 5);<br />                } else {<br />                    $language = $this -&gt; get_language_config();<br />                    $lang = $language['default_locale'];<br />                }<br />            }<br />            $this -&gt; locale = $lang;<br />        }<br />        return $this -&gt; locale;<br />    }<br />    <br />    /</strong><br />     * Get configuration values<br />     <em><br />     * @access  default<br />     * @return  array<br />     </em>/<br />    function get_language_config(){<br />        $this -&gt; CI -&gt; config -&gt; load('i18n');<br />        return $this -&gt; CI -&gt; config -&gt; item('language');<br />    }<br />    <br />}<br /><br />/<em> End of file I18n.php </em>/<br />/<em> Location: ./application/libraries/I18N.php </em>/<br /></pre><br />以下的是所需要的設定檔案 <b>i18n.php (Core)</b>，放到 <b>application/config/i18n.php</b>。<br /><pre class="brush:php">&lt;?php if (!defined('BASEPATH')) exit('No direct script access allowed');<br /><br />/<em><em><br /> * I18n library configuration file<br /> </em><br /> * @package     CodeIgniter<br /> * @subpackage  Libraries<br /> * @category    Libraries<br /> * @author      Lawrence Cheung<br /> * @version     1.0<br /> * @link        https://github.com/lawrence0819<br /> </em>/<br /><br />//Add file in this array, if you want I18n library auto load them<br />$config['language']['files'] = array('messages');<br /><br />//If user locale not found, set this valus as a defaul user locale<br />$config['language']['default_locale'] = 'en';<br /><br />//Default language folder, if locale folder not found<br />$config['language']['locale']['default'] = 'tchinese';<br /><br />//zh-CN locale mapped to schinese folder<br />$config['language']['locale']['zh-CN'] = 'schinese';<br /><br />//zh-TW locale mapped to tchinese folder<br />$config['language']['locale']['zh-TW'] = 'tchinese';<br /><br />//en locale mapped to schinese folder<br />$config['language']['locale']['en'] = 'english';<br /><br />/<em> End of file i18n.php </em>/<br />/<em> Location: ./application/config/i18n.php </em>/<br /></pre><br />英文語言檔 <b>messages_lang.php</b>，放到 <b>application/language/english/messages_lang.php</b><br /><pre class="brush:php">&lt;?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');<br /><br />$lang['site_name'] = 'Example site';<br />$lang['message'] = 'Hello World!';<br /><br />/<em> End of file messages_lang.php </em>/<br />/<em> Location: ./application/language/english/messages_lang.php </em>/<br /></pre><br />正體中文語言檔 <b>messages_lang.php</b>，放到 <b>application/language/tchinese/messages_lang.php</b><br /><pre class="brush:php">&lt;?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');<br /><br />$lang['site_name'] = '範例網站';<br />$lang['message'] = '世界，你好！';<br /><br />/<em> End of file messages_lang.php </em>/<br />/<em> Location: ./application/language/tchinese/messages_lang.php </em>/<br /></pre><br />簡體中文語言檔 <b>messages_lang.php</b>，放到 <b>application/language/schinese/messages_lang.php</b><br /><pre class="brush:php">&lt;?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');<br /><br />$lang['site_name'] = '范例网站';<br />$lang['message'] = '世界，你好！';<br /><br />/<em> End of file messages_lang.php </em>/<br />/<em> Location: ./application/language/schinese/messages_lang.php </em>/<br /></pre><br /><br />設定就完成了，如果你有更多語言或不使用 <b>english</b>，<b>tchinese</b>，<b>schinese</b> 的名稱，請更改 <b>application/config/i18n.php</b>。<br /><br /><br />使用方法如下:<br /><br />手動選擇語言的 <b>Controller</b>:<br /><pre class="brush:php">&lt;?php if (!defined('BASEPATH')) exit('No direct script access allowed');<br /><br />class I18nmanual extends CI_Controller{<br /><br />    public function </strong>construct(){<br />        parent::<strong>construct();<br />        $this -&gt; load -&gt; library('i18n');<br />    }<br />    <br />    public function index(){<br />        $this -&gt; i18n -&gt; load_language();<br />        $this -&gt; load -&gt; view('i18ntest');<br />    }<br />    <br />}<br /><br />/<em> End of file i18nmanual.php </em>/<br />/<em> Location: ./application/controller/i18nmanual.php </em>/<br /></pre><br /><b>View</b>:<br /><pre class="brush:php">&lt;html&gt;<br />    &lt;head&gt;<br />        &lt;title&gt;&lt;?php echo $this-&gt;lang-&gt;line('site_name'); ?&gt;&lt;/title&gt;<br />    &lt;/head&gt;<br />    &lt;body&gt;<br />        &lt;?php echo $this-&gt;lang-&gt;line('message'); ?&gt;<br />    &lt;/body&gt;<br />&lt;/html&gt;<br /></pre><br />將會見到和 <b>Browser</b> 相對應的語言。<br /><br />如果覺得要在 </strong>construct 內加上<br /><pre class="brush:php">$this -&gt; load -&gt; library('i18n');<br /></pre><br />太麻煩，可以在 <b>application/config/autoload.php</b> 自動載入 <b>i18n library</b>:<br /><pre class="brush:php">$autoload['libraries'] = array('i18n');<br /></pre><br />開啟全自動的功能要先在 <b>application/config/config.php</b> 更改以下程式碼:<br /><pre class="brush:php">$config['enable_hooks'] = TRUE;<br /></pre><br />再將 <b>application/config/hooks.php</b> 加入以下程式碼:<br /><pre class="brush:php">$hook['post_controller_constructor'][] = array(<br />                                'class'    =&gt; 'I18n',<br />                                'function' =&gt; 'auto_load_language',<br />                                'filename' =&gt; 'I18n.php',<br />                                'filepath' =&gt; 'libraries'<br />                                );<br /></pre><br /><b>Controller</b>:<br /><pre class="brush:php">&lt;?php if (!defined('BASEPATH')) exit('No direct script access allowed');<br /><br />class I18nauto extends CI_Controller{<br /><br />    public function <strong>construct(){<br />        parent::</strong>construct();<br />        $this -&gt; load -&gt; library('i18n');<br />    }<br />    <br />    public function index(){<br />        $this -&gt; load -&gt; view('i18ntest');<br />    }<br />    <br />}<br /><br />/<em> End of file i18nauto.php </em>/<br />/<em> Location: ./application/controller/i18nauto.php </em>/<br /></pre><br />如果有設定自動載入 <b>i18n library</b>，就連 <b><strong>construct</b> 也不需要。<br /><br />如果開啟了全自動的功能，但有些 <b>Controller</b> 又不想自動選擇語言，可以在 <b></strong>construct</b> 加上:<br /><pre class="brush:php">&lt;?php if (!defined('BASEPATH')) exit('No direct script access allowed');<br /><br />class I18nmanual extends CI_Controller{<br /><br />    public function <strong>construct(){<br />        parent::</strong>construct();<br />        $this -&gt; load -&gt; library('i18n');<br />        //prevent auto load language<br />        $this -&gt; i18n -&gt; prevent_auto();<br />    }<br />    <br />    public function index(){<br />        $this -&gt; i18n -&gt; set_current_locale('zh-TW');<br />        $this -&gt; i18n -&gt; load_language();<br />        $this -&gt; load -&gt; view('i18ntest');<br />    }<br />    <br />}<br /><br />/<em> End of file i18nmanual.php </em>/<br />/<em> Location: ./application/controller/i18nmanual.php </em>/<br /></pre><br />一經切換的語系，就會自動將此更改儲存到 <b>Cookies</b>，下一次就會以 <b>Cookies</b> 的語系來選擇語言檔。<br /><br />說明完畢，有什麼問題可以留言給我。<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-5619452461244676124?l=pro.ctlok.com' alt='' /></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ZK I18N Advanced]]></title>
    <link href="http://lawrence0819.github.com/2010/07/zk-i18n-advanced.html"/>
    <updated>2010-07-02T14:45:00+08:00</updated>
    <id>http://lawrence0819.github.com/2010/07/zk-i18n-advanced</id>
    <content type="html"><![CDATA[<p>以前也已經講解過 ZK 轉換語言的方法: <a href="http://pro.ctlok.com/2010/04/zk-internationalization-and.html">ZK I18N</a><br /><br />因為考慮到 ZK 頁面可能會由數個 ZK 元件組合出來，如果每一個元件也要加入 ZK Controller 來設定語言會很麻煩，所以想了一個方法去解決這個問題。<br /><br />在這裡我會在 <b>index.zul</b> 使用 <a href="http://docs.zkoss.org/wiki/StyleGuide_Borderlayout">Border Layout</a>，使以會有 5 個元件頁面，分別是 <b>North.zul</b>, <b>East.zul</b>, <b>Center.zul</b>, <b>West.zul</b>, <b>South.zul</b>。而 <b>Center.zul</b> 將會放一個控制語言的元件用作轉換其他元件的語言。<br /><br />首先在新增一個 <b>component folder</b>在 <b>WEB-INF</b> 內。<br /><br />再新增 <b>East.zul</b> 在 <b>component folder</b>內。<br />/WEB-INF/component/East.zul:<br /><pre class="brush: xml">&lt;window id="East" border="none"&gt;<br />    &lt;label id="pageName" value="East" /&gt;<br />    &lt;button id="btn" label="Button" /&gt;<br />&lt;/window&gt;<br /></pre><br />要記住每一個 zul 的頁面的 <b>Root Element id</b> 要跟 zul 頁面名稱一樣，之後用到時比較好分辨。<br /><br />/WEB-INF/component/North.zul:<br /><pre class="brush: xml">&lt;window id="North" border="none"&gt;<br />    &lt;label id="pageName" value="North" /&gt;<br />    &lt;button id="btn" label="Button" /&gt;<br />&lt;/window&gt;<br /></pre><br />/WEB-INF/component/South.zul:<br /><pre class="brush: xml">&lt;window id="South" border="none"&gt;<br />    &lt;label id="pageName" value="South" /&gt;<br />    &lt;button id="btn" label="Button" /&gt;<br />&lt;/window&gt;<br /></pre><br />/WEB-INF/component/West.zul:<br /><pre class="brush: xml">&lt;window id="West" border="none"&gt;<br />    &lt;label id="pageName" value="West" /&gt;<br />    &lt;button id="btn" label="Button" /&gt;<br />&lt;/window&gt;<br /></pre><br />現在新增 index.zul 在根目錄。<br />/index.zul:<br /><pre class="brush: xml">&lt;?page title="Index Page"?&gt;<br />&lt;zk&gt;<br />    &lt;borderlayout&gt;<br />        &lt;north&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/North.zul" /&gt;&lt;/north&gt;<br />        &lt;east&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/East.zul" /&gt;&lt;/east&gt;<br />        &lt;center&gt;&lt;/center&gt;<br />        &lt;west&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/West.zul" /&gt;&lt;/west&gt;<br />        &lt;south&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/South.zul" /&gt;&lt;/south&gt;<br />    &lt;/borderlayout&gt;<br />&lt;/zk&gt;<br /></pre><br />打開 <b>index.zul</b> 頂面看看是否這個樣子:<br /><div class="separator" style="clear: both; text-align: left;"><a href="http://2.bp.blogspot.com/_fDN8R2Wgbcs/TC1ySKbhD1I/AAAAAAAAAi8/1dq357dI2kY/s1600/zk-i18n.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="189" src="http://2.bp.blogspot.com/_fDN8R2Wgbcs/TC1ySKbhD1I/AAAAAAAAAi8/1dq357dI2kY/s320/zk-i18n.png" width="320" /></a></div><br />現在新增一個 Java Class 是轉換語言的核心元件。只是很簡單的程式碼，看不明再問我吧。<br />com.ctlok.pro.zk.language.I18N:<br /><pre class="brush: java">package com.ctlok.pro.zk.language;<br /><br />import java.util.List;<br /><br />import org.zkoss.util.resource.Labels;<br />import org.zkoss.zk.ui.Component;<br />import org.zkoss.zk.ui.IdSpace;<br />import org.zkoss.zul.Button;<br />import org.zkoss.zul.Label;<br /><br />public class I18N {<br /><br />    @SuppressWarnings("unchecked")<br />    public static void setLanguage(Component rootComponent) {<br />        List&lt;Component&gt; components = (List&lt;Component&gt;) rootComponent<br />                .getChildren();<br />        for (int i = 0; i &lt; components.size(); i++) {<br />            Component component = components.get(i);<br />            setComponentLanguage(component);<br />            if (component.getChildren().size() &gt; 0)<br />                setLanguage(component);<br />        }<br />    }<br />    <br />    private static void setComponentLanguage(Component component) {<br />        IdSpace owner = component.getSpaceOwner();<br />        if (owner instanceof Component) {<br />            String ownerId = ((Component)owner).getId();<br />            String i18n = Labels.getLabel(ownerId + "." + component.getId());<br />            if (i18n != null) {<br />                if (component instanceof Label)<br />                    ((Label) component).setValue(i18n);<br />                else if (component instanceof Button)<br />                    ((Button) component).setLabel(i18n);<br />            }<br />        }<br />    }<br />}<br /></pre><br />有了核心元件，也要有語言檔案才行。<br />/WEB-INF/i3-label.properties:<br /><pre class="brush: text">#i18n<br />North.pageName=North<br />North.btn=Button<br /><br />East.pageName=East<br />East.btn=Button<br /><br />South.pageName=South<br />South.btn=Button<br /><br />West.pageName=West<br />West.btn=Button<br /></pre><br />/WEB-INF/i3-label_zh.properties:<br /><pre class="brush: text">#i18n<br />North.pageName=北<br />North.btn=按鈕<br /><br />East.pageName=東<br />East.btn=按鈕<br /><br />South.pageName=南<br />South.btn=按鈕<br /><br />West.pageName=西<br />West.btn=按鈕<br /></pre><br />/WEB-INF/i3-label_en.properties:<br /><pre class="brush: text">#i18n<br />North.pageName=North<br />North.btn=Button<br /><br />East.pageName=East<br />East.btn=Button<br /><br />South.pageName=South<br />South.btn=Button<br /><br />West.pageName=West<br />West.btn=Button<br /></pre><br />/WEB-INF/i3-label_ja.properties:<br /><pre class="brush: text">#i18n<br />North.pageName=北<br />North.btn=ボタン<br /><br />East.pageName=東<br />East.btn=ボタン<br /><br />South.pageName=南<br />South.btn=ボタン<br /><br />West.pageName=西<br />West.btn=ボタン<br /></pre><br />一共有 4 個語言檔，而 i3-label.properties 是預設的語言檔案，當找不到合適的語言時便會用到。<br /><br />North.pageName=North 前面的 North 就是剛才提到的頁面 <b>Root Element id</b>，這樣便可以分到那一個元件是那一個 zul 頁面了，也不會怕和其他頁面的元件 ID 相撞。<br /><br />有了這些還不夠，還要有一個元件去結用戶去選擇語言才行。<br /><br />新增一個 com.ctlok.pro.zk.component.LanguageCombobox:<br /><pre class="brush: java">package com.ctlok.pro.zk.component;<br /><br />import java.util.Locale;<br /><br />import org.zkoss.util.Locales;<br />import org.zkoss.web.Attributes;<br />import org.zkoss.zk.ui.Session;<br />import org.zkoss.zk.ui.Sessions;<br />import org.zkoss.zul.Combobox;<br />import org.zkoss.zul.ListModel;<br />import org.zkoss.zul.SimpleListModel;<br /><br />import com.ctlok.pro.zk.language.I18N;<br /><br />public class LanguageCombobox extends Combobox {<br /><br />    private static final long serialVersionUID = 1L;<br /><br />    public LanguageCombobox() {<br />        Locale[] model = new Locale[3];<br />        model[0] = Locale.ENGLISH;<br />        model[1] = Locale.CHINESE;<br />        model[2] = Locale.JAPANESE;<br /><br />        setModel(new SimpleListModel(model));<br />    }<br /><br />    public void onInitRenderLater() throws InterruptedException {<br />        Locale locale = Locales.getThreadLocal();<br />        ListModel languages = this.getModel();<br />        setSelectedIndex(0);<br />        for (int i = 0; i &lt; languages.getSize(); i++) {<br />            if (locale.getDisplayLanguage().equals(<br />                    ((Locale) languages.getElementAt(i)).getDisplayLanguage())) {<br />                setSelectedIndex(i);<br />                return;<br />            }<br />        }<br />    }<br /><br />    public void onCreate() {<br />        I18N.setLanguage(getRoot());<br />    }<br /><br />    public void onChange() {<br />        Locale locale = (Locale) this.getModel().getElementAt(<br />                this.getSelectedIndex());<br />        setDefaultLanguage(locale);<br />        I18N.setLanguage(getRoot());<br />    }<br /><br />    public void setDefaultLanguage(Locale locale) {<br />        Session session = Sessions.getCurrent();<br />        session.setAttribute(Attributes.PREFERRED_LOCALE, locale);<br />        Locales.setThreadLocal(locale);<br />    }<br /><br />}<br /></pre>在 Constructor 內設定了 3 種語言選擇。  <br /><br />onInitRenderLater() 選取用戶現在正在使用的語言。  <br /><br />onCreate() 將頁面的語言轉換為用戶正在使用的語言，如果還用戶還未選擇語言，跟瀏覽器的語言來設定。  <br /><br />onChange() 用戶轉換語言時會將預設的語言設定為用戶所選擇語言。  <br /><br />setDefaultLanguage() 設定用戶預設語言。  <br /><br />加入此元件的頁面也會自動設定該頁面的語言，很方便吧。  <br /><br />現在元件已經有了，那放到 zul 頁面顯示出來。  <br /><br />新增 /WEB-INF/component/Center.zul: <br /><pre class="brush: xml">&lt;window id="Center" border="none"&gt;<br />    &lt;combobox use="com.ctlok.pro.zk.component.LanguageCombobox" /&gt;<br />&lt;/window&gt;<br /></pre>/index.zul 頁面亦要改一改。 index.zul: <br /><pre class="brush: xml">&lt;?page title="Index Page"?&gt;<br />&lt;zk&gt;<br />    &lt;borderlayout&gt;<br />        &lt;north&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/North.zul" /&gt;&lt;/north&gt;<br />        &lt;east&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/East.zul" /&gt;&lt;/east&gt;<br />        &lt;center&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/Center.zul" /&gt;&lt;/center&gt;<br />        &lt;west&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/West.zul" /&gt;&lt;/west&gt;<br />        &lt;south&gt;&lt;include src="http://lawrence0819.github.com/WEB-INF/component/South.zul" /&gt;&lt;/south&gt;<br />    &lt;/borderlayout&gt;<br />&lt;/zk&gt;<br /></pre><br />以下是轉換各種語言的樣子:<br /><br /><div class="separator" style="clear: both; text-align: left;"><a href="http://2.bp.blogspot.com/_fDN8R2Wgbcs/TC2KU4VkGoI/AAAAAAAAAjE/4VShZwsKSvc/s1600/zk-i18n-1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="189" src="http://2.bp.blogspot.com/_fDN8R2Wgbcs/TC2KU4VkGoI/AAAAAAAAAjE/4VShZwsKSvc/s320/zk-i18n-1.png" width="320" /></a></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="http://4.bp.blogspot.com/_fDN8R2Wgbcs/TC2KVTnuNUI/AAAAAAAAAjI/Du7dGjmLPDA/s1600/zk-i18n-2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="189" src="http://4.bp.blogspot.com/_fDN8R2Wgbcs/TC2KVTnuNUI/AAAAAAAAAjI/Du7dGjmLPDA/s320/zk-i18n-2.png" width="320" /></a></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="http://4.bp.blogspot.com/_fDN8R2Wgbcs/TC2KUjBBNjI/AAAAAAAAAjA/Xlt4-XN-HvE/s1600/zk-i18n-3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="189" src="http://4.bp.blogspot.com/_fDN8R2Wgbcs/TC2KUjBBNjI/AAAAAAAAAjA/Xlt4-XN-HvE/s320/zk-i18n-3.png" width="320" /></a></div><br />範例: <a href="http://sites.google.com/site/lawrencespace/lawpronotes/download/zk-i18n-advanced.zip">zk-i18n-advanced.zip</a> (Eclipse Project)<br /><b><strong><strong> 需要自行加上 ZK 5.01 Library </strong></strong></b><br /><br />相關書籍: <a href="http://www.amazon.com/ZK-Ajax-without-Javascript-Framework/dp/1590599012?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="ZK: Ajax without the Javascript Framework" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=1590599012&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=1590599012" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Developers-Guide-Developing-applications-development/dp/1847192009?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="ZK Developer's Guide: Developing responsive user interfaces for web applications using Ajax, XUL, and the open source ZK rich web client development framework" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=1847192009&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=1847192009" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Head-First-Java-Kathy-Sierra/dp/0596009208?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Head First Java, 2nd Edition" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0596009208&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0596009208" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-9160651432083889603?l=pro.ctlok.com' alt='' /></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ZK Internationalization and localization (I18N)]]></title>
    <link href="http://lawrence0819.github.com/2010/04/zk-internationalization-and.html"/>
    <updated>2010-04-29T18:16:00+08:00</updated>
    <id>http://lawrence0819.github.com/2010/04/zk-internationalization-and</id>
    <content type="html"><![CDATA[<p>ZK 官方的 I18N 教學非常缺乏彈性。<br />網址: <a href="http://www.zkoss.org/smalltalks/i18n/i18n.dsp">http://www.zkoss.org/smalltalks/i18n/i18n.dsp</a><br /><br />官方的 I18N 教學是一個一個元件去設定語言，如果有一百個元件就會有一百行程式碼，所以另外想了一個方法去解決這個問題。<br /><br />首先新增一個 package 為 com.blogspot.lawpronotes.controller，並制作一個 Controller，名命為  IndexController。<br /><br />IndexController:<br /><pre class="brush: java">package com.blogspot.lawpronotes.controller;<br /><br />import org.zkoss.zk.ui.util.GenericForwardComposer;<br /><br />public class IndexController extends GenericForwardComposer {<br /><br />    private static final long serialVersionUID = 1L;<br /><br />    @Override<br />    public void doAfterCompose(Component comp) throws Exception {<br />        super.doAfterCompose(comp);<br />    }<br />}<br /></pre><br /><br />在 / 制作一個 index.zul 頁面<br /><br />index.zul:<br /><pre class="brush: xml">&lt;?page title="Auto Generated index.zul"?&gt;<br />&lt;zk&gt;<br />    &lt;window title="i18n" border="normal" width="500px"<br />        apply="com.blogspot.lawpronotes.controller.IndexController"&gt;<br />        &lt;panel&gt;<br />            &lt;toolbar&gt;<br />                &lt;button id="btnChinese" label="中文"/&gt;<br />                &lt;button id="btnEnglish" label="English"/&gt;<br />                &lt;button id="btnJapanese" label="日本語"/&gt;<br />                &lt;button id="btnFrench" label="Français"/&gt;<br />            &lt;/toolbar&gt;<br />            &lt;panelchildren&gt;<br />                &lt;grid&gt;<br />                    &lt;rows&gt;<br />                        &lt;row&gt;<br />                            &lt;label id="lbUsername" /&gt;<br />                            &lt;textbox id="txtUsername" type="text" width="98%" /&gt;<br />                        &lt;/row&gt;<br />                        &lt;row&gt;<br />                            &lt;label id="lbPassword" /&gt;<br />                            &lt;textbox id="txtPassword" type="password" width="98%" /&gt;<br />                        &lt;/row&gt;<br />                        &lt;row&gt;<br />                            &lt;space /&gt;<br />                            &lt;button id="btnSubmit" /&gt;<br />                        &lt;/row&gt;<br />                    &lt;/rows&gt;<br />                &lt;/grid&gt;<br />            &lt;/panelchildren&gt;<br />        &lt;/panel&gt;<br />    &lt;/window&gt;<br />&lt;/zk&gt;<br /></pre><br />現在 index.zul 頁面的 Label 是沒有任何文字的，現在新增五個語言檔案，分別為 i3-label.properties、i3-label_en.properties、i3-label_fr.properties、i3-label_jp.properties 和 i3-label_zh.properties。全部的 properties 檔案都是放到 /WEB-INF 內<br /><br /><strong>*ZK 的 properties 檔案是用 UTF-8 編碼。<br /><br />i3-label.properties:<br /><pre class="brush: text">#index.zul<br /><br />/index.zul/lbUsername=Username:<br />/index.zul/lbPassword=Password:<br />/index.zul/btnSubmit=Submit<br /></pre><br />i3-label_en.properties:<br /><pre class="brush: text">#index.zul<br /><br />/index.zul/lbUsername=Username:<br />/index.zul/lbPassword=Password:<br />/index.zul/btnSubmit=Submit<br /></pre><br />i3-label_fr.properties:<br /><pre class="brush: text">#index.zul<br /><br />/index.zul/lbUsername=Nom d'utilisateur:<br />/index.zul/lbPassword=Mot de passe:<br />/index.zul/btnSubmit=Soumettre<br /></pre><br />i3-label_jp.properties:<br /><pre class="brush: text">#index.zul<br /><br />/index.zul/lbUsername=ユーザー名:<br />/index.zul/lbPassword=パスワード:<br />/index.zul/btnSubmit=登録<br /></pre><br />i3-label_zh.properties:<br /><pre class="brush text">#index.zul<br /><br />/index.zul/lbUsername=用戶名稱:<br />/index.zul/lbPassword=密碼:<br />/index.zul/btnSubmit=確定<br /></pre><br />properties 檔案內的 /index.zul 是元件的頁面位置和名稱，而 /lbUsername，/lbPassword 和 /btnSubmit 是元件的 ID，這樣確保了名稱不會相同。<br /><br />現在有了語言檔，可以在 Controller 內讀取語言檔然後再加到元件上。<br />新增以下的方法到 IndexController 內。<br /><pre class="brush: java">@SuppressWarnings("unchecked")<br />    private void setLanguage(Component rootComponent) {<br />        List&lt;Component&gt; components = (List&lt;Component&gt;) rootComponent<br />                .getChildren();<br />        for (int i = 0; i &lt; components.size(); i++) {<br />            Component component = components.get(i);<br />            setComponentLanguage(component);<br />            if (component.getChildren().size() &gt; 0)<br />                setLanguage(component);<br />        }<br />    }<br />    <br />    private void setComponentLanguage(Component component) {<br />        String path = component.getPage().getRequestPath();<br />        String i18n = Labels.getLabel(path + "/" + component.getId());<br />        if (i18n != null) {<br />            if (component instanceof Label)<br />                ((Label) component).setValue(i18n);<br />            else if (component instanceof Button)<br />                ((Button) component).setLabel(i18n);<br />        }<br />    }<br />    <br />    private void changeLocale(String locale) {<br />        Session session = Sessions.getCurrent();<br />        Locale preferredLocale = Locales.getLocale(locale);<br />        session.setAttribute(Attributes.PREFERRED_LOCALE, preferredLocale);<br />        Locales.setThreadLocal(preferredLocale);<br />        setLanguage(self);<br />    }<br /></pre><br />而 doAfterCompose 方法則修改為以下這樣:<br /><pre class="brush: java">@Override<br />    public void doAfterCompose(Component comp) throws Exception {<br />        super.doAfterCompose(comp);<br />        setLanguage(self);<br />    }<br /></pre><br />現在可以試試打開 index.zul 頁面看看是不是自動加入了文字，成功應該會像以下這樣。<br /><br /><div class="separator" style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/_fDN8R2Wgbcs/S9lZ7mwZ27I/AAAAAAAAAew/XaxKTONxtMA/s1600/indexzul.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="100" src="http://3.bp.blogspot.com/_fDN8R2Wgbcs/S9lZ7mwZ27I/AAAAAAAAAew/XaxKTONxtMA/s320/indexzul.png" width="320" /></a></div><br />現在頁上的按鈕還沒有作用，可以加入以下的方法去令按鈕產生作用。<br /><pre class="brush: java">public void onClick$btnChinese(){<br />        changeLocale("zh");<br />    }<br />    <br />    public void onClick$btnEnglish(){<br />        changeLocale("en");<br />    }<br />    <br />    public void onClick$btnJapanese(){<br />        changeLocale("jp");<br />    }<br />    <br />    public void onClick$btnFrench(){<br />        changeLocale("fr");<br />    }<br /></pre><br />完整的 IndexController:<br /><pre class="brush: java">package com.blogspot.lawpronotes.controller;<br /><br />import java.util.List;<br />import java.util.Locale;<br /><br />import org.zkoss.util.Locales;<br />import org.zkoss.util.resource.Labels;<br />import org.zkoss.web.Attributes;<br />import org.zkoss.zk.ui.Component;<br />import org.zkoss.zk.ui.Session;<br />import org.zkoss.zk.ui.Sessions;<br />import org.zkoss.zk.ui.util.GenericForwardComposer;<br />import org.zkoss.zul.Button;<br />import org.zkoss.zul.Label;<br />import org.zkoss.zul.Panel;<br /><br />public class IndexController extends GenericForwardComposer {<br /><br />    private static final long serialVersionUID = 1L;<br /><br />    @Override<br />    public void doAfterCompose(Component comp) throws Exception {<br />        super.doAfterCompose(comp);<br />        setLanguage(self);<br />    }<br />    <br />    public void onClick$btnChinese(){<br />        changeLocale(&quot;zh&quot;);<br />    }<br />    <br />    public void onClick$btnEnglish(){<br />        changeLocale(&quot;en&quot;);<br />    }<br />    <br />    public void onClick$btnJapanese(){<br />        changeLocale(&quot;jp&quot;);<br />    }<br />    <br />    public void onClick$btnFrench(){<br />        changeLocale(&quot;fr&quot;);<br />    }<br /><br />    @SuppressWarnings(&quot;unchecked&quot;)<br />    private void setLanguage(Component rootComponent) {<br />        List&lt;Component&gt; components = (List&lt;Component&gt;) rootComponent<br />                .getChildren();<br />        for (int i = 0; i &lt; components.size(); i++) {<br />            Component component = components.get(i);<br />            setComponentLanguage(component);<br />            if (component.getChildren().size() &gt; 0)<br />                setLanguage(component);<br />        }<br />    }<br />    <br />    private void setComponentLanguage(Component component) {<br />        String path = component.getPage().getRequestPath();<br />        String i18n = Labels.getLabel(path + &quot;/&quot; + component.getId());<br />        if (i18n != null) {<br />            if (component instanceof Label)<br />                ((Label) component).setValue(i18n);<br />            else if (component instanceof Button)<br />                ((Button) component).setLabel(i18n);<br />        }<br />    }<br />    <br />    private void changeLocale(String locale) {<br />        Session session = Sessions.getCurrent();<br />        Locale preferredLocale = Locales.getLocale(locale);<br />        session.setAttribute(Attributes.PREFERRED_LOCALE, preferredLocale);<br />        Locales.setThreadLocal(preferredLocale);<br />        setLanguage(self);<br />    }<br />}<br /></pre><br />現在應該能夠立即轉換頁面語言了。<br /><br /><div class="separator" style="clear: both; text-align: left;"><a href="http://1.bp.blogspot.com/_fDN8R2Wgbcs/S9lcWZ9K87I/AAAAAAAAAe0/ztSTI798GD8/s1600/indexzul2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="100" src="http://1.bp.blogspot.com/_fDN8R2Wgbcs/S9lcWZ9K87I/AAAAAAAAAe0/ztSTI798GD8/s320/indexzul2.png" width="320" /></a></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="http://2.bp.blogspot.com/_fDN8R2Wgbcs/S9lcW_yfv9I/AAAAAAAAAe4/HDigy1dHC8A/s1600/indexzul3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="99" src="http://2.bp.blogspot.com/_fDN8R2Wgbcs/S9lcW_yfv9I/AAAAAAAAAe4/HDigy1dHC8A/s320/indexzul3.png" width="320" /></a></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="http://2.bp.blogspot.com/_fDN8R2Wgbcs/S9lcXagDotI/AAAAAAAAAe8/T4_zfh-EBTA/s1600/indexzul4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="99" src="http://2.bp.blogspot.com/_fDN8R2Wgbcs/S9lcXagDotI/AAAAAAAAAe8/T4_zfh-EBTA/s320/indexzul4.png" width="320" /></a></div><br /><br />其實還有方法可令轉換語言更好，不用每一個 Controller 也有相同的方法，<strike>遲一點再補上來</strike>。<br /><a href="http://pro.ctlok.com/2010/07/zk-i18n-advanced.html">ZK I18N Advanced</a><br /><br />範例下載: <a href="http://sites.google.com/site/lawrencespace/lawpronotes/download/i18n.7z?attredirects=0&d=1">i18n.7z</a> (密碼:lawpronotes)<br /><br /></strong>因 ZK Library 太大，請自行加入 ZK 5.0.1 Library 到 /WEB-INF/lib 下。<br /><br />相關書籍: <a href="http://www.amazon.com/Developers-Guide-Developing-applications-development/dp/1847192009?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="ZK Developer's Guide: Developing responsive user interfaces for web applications using Ajax, XUL, and the open source ZK rich web client development framework" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=1847192009&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=1847192009" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/ZK-Ajax-without-Javascript-Framework/dp/1590599012?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="ZK: Ajax without the Javascript Framework" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=1590599012&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=1590599012" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Head-First-Java-Kathy-Sierra/dp/0596009208?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Head First Java, 2nd Edition" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0596009208&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0596009208" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-8904115902016697427?l=pro.ctlok.com' alt='' /></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[利用 JavaServer Pages Standard Tag Library (JSTL) 切換網頁語言 (i18n)]]></title>
    <link href="http://lawrence0819.github.com/2010/02/javaserver-pages-standard-tag-library.html"/>
    <updated>2010-02-09T11:50:00+08:00</updated>
    <id>http://lawrence0819.github.com/2010/02/javaserver-pages-standard-tag-library</id>
    <content type="html"><![CDATA[<p>利用 JSTL 的&nbsp;Internationalization Tag Library 可以輕鬆的做出支援多國語言的網頁。<br /><br />先增加一個 Package:&nbsp;com.blogspot.lawpronotes.language。<br />在&nbsp;com.blogspot.lawpronotes.language 內新增 3 個 .properties ，命名為&nbsp;form.properties 、form_en.properties 和&nbsp;form_zh.properties。因為 .properties 檔案必須使用&nbsp;ISO 8859-1 編碼，所以是不能直接輸入中文的，要轉換成 Unicode 才可以。<br /><br />使用 Eclipse 的可以參考這篇去安裝 Properties Editor:&nbsp;<a href="http://lawpronotes.blogspot.com/2010/02/eclipse-plugin-properties-editor.html">http://lawpronotes.blogspot.com/2010/02/eclipse-plugin-properties-editor.html</a><br /><br />使用 Properties Editor 可以直接將以下文字複製。<br /><br />form.properties<br /><pre class="brush: text">userName=用戶名稱<br />password=密碼<br /></pre><br />form_en.properties<br /><pre class="brush: text">userName=User Name<br />password=Password<br /></pre><br />form_zh.properties<br /><pre class="brush: text">userName=用戶名稱<br />password=密碼<br /></pre><br />非使用 Properties Editor 請複製以下內容。<br /><br />form.properties<br /><pre class="brush: text">userName=\u7528\u6236\u540d\u7a31<br />password=\u5bc6\u78bc<br /></pre><br />form_en.properties<br /><pre class="brush: text">userName=User Name<br />password=Password<br /></pre><br />form_zh.properties<br /><pre class="brush: text">userName=\u7528\u6236\u540d\u7a31<br />password=\u5bc6\u78bc<br /></pre><br />現在新增一個 JSP 檔案，將以下內容複製到 JSP 檔案內。<br /><pre class="brush: html">&lt;%@page contentType="text/html" pageEncoding="UTF-8"%&gt;<br />&lt;%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%&gt;<br />&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"<br />                    "http://www.w3.org/TR/html4/loose.dtd"&gt;<br />&lt;html&gt;<br />    &lt;head&gt;<br />        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;<br />        &lt;title&gt;GlassFish JSP Page&lt;/title&gt;<br />    &lt;/head&gt;<br />    &lt;body&gt;<br />        &lt;fmt:setLocale value="en" /&gt;<br />        &lt;fmt:setBundle basename="com/blogspot/lawpronotes/language/form" var="formBundle" /&gt;<br />        &lt;form&gt;<br />            &lt;label&gt;&lt;fmt:message key="userName" bundle="${formBundle}" /&gt;: &lt;/label&gt;<br />            &lt;input type="text" /&gt;&lt;br /&gt;<br />            &lt;label&gt;&lt;fmt:message key="password" bundle="${formBundle}" /&gt;: &lt;/label&gt;<br />            &lt;input type="text" /&gt;&lt;br /&gt;<br />        &lt;/form&gt;<br />    &lt;/body&gt;<br />&lt;/html&gt;<br /></pre><br />使用瀏覽器去看一看會看見以下畫面。<br /><div class="separator" style="clear: both; text-align: left;"><a href="http://2.bp.blogspot.com/_fDN8R2Wgbcs/S3DXkPkjgMI/AAAAAAAAAdU/87jlgtlmmOo/s1600-h/jstli8n.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_fDN8R2Wgbcs/S3DXkPkjgMI/AAAAAAAAAdU/87jlgtlmmOo/s320/jstli8n.png" /></a></div><br />現在將<br /><pre class="brush: html">&lt;fmt:setLocale value="en" /&gt;<br /></pre><br />改成<br /><pre class="brush: html">&lt;fmt:setLocale value="zh" /&gt;<br /></pre><br />使用瀏覽器去看一看會變成以下畫面。<br /><div class="separator" style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/_fDN8R2Wgbcs/S3DYQZo3dmI/AAAAAAAAAdc/-6z62eRqn5Q/s1600-h/jstli8n1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_fDN8R2Wgbcs/S3DYQZo3dmI/AAAAAAAAAdc/-6z62eRqn5Q/s320/jstli8n1.png" /></a></div><br />現在解釋一下。<br />這句是宣告此 JSP 使用 Internationalization Tag Library。<br /><pre class="brush: html">&lt;%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%&gt;<br /></pre><br />這句是將宣告此頁面是那種語言。value 是根據你設定的語言而找出相對應的語言檔，即是 <em>en 和 </em>zh。<br /><pre class="brush: html">&lt;fmt:setLocale value="en" /&gt;<br /></pre><br />這句是找出指定的語言檔，因為利用了 &lt;fmt:setLocale value="en" /&gt; 來設定語言，所以不必將 form 換成 form_en 或 form_zh。其中的 var="formBundle" 是將語言檔放進變數內，這意味著同一個頁面可以引入多個語言檔。如果找不到語言檔就會使用預設語言檔，即是 form.properties。<br /><pre class="brush: html">&lt;fmt:setBundle basename="com/blogspot/lawpronotes/language/form" var="formBundle" /&gt;<br /></pre><br />這句是在 formBundle 這個變數內找出關鍵字再顯示出來。因為已經將語言檔放進變數內。<br /><pre class="brush: html">&lt;fmt:message key="userName" bundle="${formBundle}" /&gt;<br /></pre><br />最後大家當然使用自己的創作力去令切換語言更有彈性。<br /><br />相關書籍: <a href="http://www.amazon.com/JSTL-Action-Shawn-Bayern/dp/1930110529?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="JSTL in Action" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=1930110529&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=1930110529" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/Core-JSTL-Mastering-Standard-Library/dp/0131001531?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="Core JSTL: Mastering the JSP Standard Tag Library" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0131001531&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0131001531" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><a href="http://www.amazon.com/JSTL-Practical-Guide-Programmers-Guides/dp/0126567557?ie=UTF8&amp;tag=program06-20&amp;link_code=bil&amp;camp=213689&amp;creative=392969" imageanchor="1" target="_blank"><img alt="JSTL: Practical Guide for JSP Programmers (The Practical Guides)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL160_&amp;ASIN=0126567557&amp;tag=program06-20" /></a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=program06-20&amp;l=bil&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0126567557" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-5921232724691983944?l=pro.ctlok.com' alt='' /></div></p>
]]></content>
  </entry>
  
</feed>
