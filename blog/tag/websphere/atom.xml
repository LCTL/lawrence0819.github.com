<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Websphere | Programming Design Notes]]></title>
  <link href="http://pro.ctlok.com/blog/tag/websphere/atom.xml" rel="self"/>
  <link href="http://pro.ctlok.com/"/>
  <updated>2012-03-26T14:22:50+08:00</updated>
  <id>http://pro.ctlok.com/</id>
  <author>
    <name><![CDATA[Lawrence Cheung]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Seam 2 in Websphere 7 EJB JNDI Setting]]></title>
    <link href="http://pro.ctlok.com/2011/06/seam-2-in-websphere-7-ejb-jndi-setting.html"/>
    <updated>2011-06-14T10:44:00+08:00</updated>
    <id>http://pro.ctlok.com/2011/06/seam-2-in-websphere-7-ejb-jndi-setting</id>
    <content type="html"><![CDATA[<p><b>Seam</b> 在 <b>JBoss Application Server</b> 上將 <b>EJB session bean</b> 設為 <b>Seam Component</b> 根本不需要特地去設定 <b>JNDI</b>，<b>Seam</b> 自然地找到相對應的 <b>Session bean</b>。<br /><br />但在 <b>Websphere 7 Application Server</b> 上就不是這回事了，需要自行設定 <b>JNDI</b> 讓 <b>Seam</b> 找得到 (將 <b>EJB session bean</b> 設為 <b>Seam Component</b> 才需要更改 <b>JNDI</b>，純 <b>EJB session bean</b> 不需要作出任何更改)<br /><br />這篇文章只使用我認為最好的方法。<br /><br />首先到 <b>web.xml</b> 加上以下設定:<br /><br /><pre class="brush: xml">&lt;ejb-local-ref&gt;<br />    &lt;ejb-ref-name&gt;ejblocal:EjbSynchronizations&lt;/ejb-ref-name&gt;<br />    &lt;ejb-ref-type&gt;Session&lt;/ejb-ref-type&gt;<br />    &lt;local-home&gt;&lt;/local-home&gt;<br />    &lt;local&gt;org.jboss.seam.transaction.LocalEjbSynchronizations&lt;/local&gt;<br />&lt;/ejb-local-ref&gt;<br /></pre><br />然後在 <b>WEB-INF/classes</b> 加入一個 <b>seam-jndi.prpperties</b>:<br /><pre class="brush: text">com.ibm.websphere.naming.hostname.normalizer=com.ibm.ws.naming.util.DefaultHostnameNormalizer<br />java.naming.factory.initial=com.ibm.websphere.naming.WsnInitialContextFactory<br />com.ibm.websphere.naming.name.syntax=jndi<br />com.ibm.websphere.naming.namespace.connection=lazy<br />com.ibm.ws.naming.ldap.ldapinitctxfactory=com.sun.jndi.ldap.LdapCtxFactory<br />com.ibm.websphere.naming.jndicache.cacheobject=populated<br />com.ibm.websphere.naming.namespaceroot=defaultroot<br />com.ibm.ws.naming.wsn.factory.initial=com.ibm.ws.naming.util.WsnInitCtxFactory<br />com.ibm.websphere.naming.jndicache.maxcachelife=0<br />com.ibm.websphere.naming.jndicache.maxentrylife=0<br />com.ibm.websphere.naming.jndicache.cachename=providerURL<br />java.naming.provider.url=corbaloc:rir:/NameServiceServerRoot<br />java.naming.factory.url.pkgs=com.ibm.ws.runtime\:com.ibm.ws.naming<br /></pre><br />再將 <b>WEB-INF/components.xml</b> 內的 <b>jndi-pattern</b> 更改為:<br /><pre class="brush: xml">&lt;core:init <br />    jndi-pattern=&quot;ejblocal:#{ejbName}&quot; <br />    debug=&quot;false&quot; /&gt;<br /></pre><br />最後就是設定 <b>Websphere</b> 的 <b>EJB session bean JNDI</b>，在 <b>EJB Project</b> 內的 <b>META-INF</b> 加入 <b>ibm-ejb-jar-bnd.xml</b>:<br /><pre class="brush: xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;ejb-jar-bnd xmlns=&quot;http://websphere.ibm.com/xml/ns/javaee&quot;<br />    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br />    xsi:schemaLocation=&quot;http://websphere.ibm.com/xml/ns/javaee <br />                      http://websphere.ibm.com/xml/ns/javaee/ibm-ejb-jar-bnd_1_0.xsd&quot;<br />    version=&quot;1.0&quot;&gt;<br /><br />    &lt;session name=&quot;MyBean&quot; simple-binding-name=&quot;MyBean&quot; /&gt;<br /><br />&lt;/ejb-jar-bnd&gt;<br /></pre><br /><b>simple-binding-name</b> 就是 <b>JNDI</b>，這樣 <b>Seam</b> 會照著 <b>components.xml</b> 內的 <b>jndi-pattern</b> 去使用以下的 <b>JNDI</b> 找到 <b>EJB session bean</b>:<br /><pre class="brush: text">ejblocal:MyBean<br /></pre><br />如果 <b>components.xml</b> 內的 <b>jndi-pattern</b> 改變了，亦要去更改 <b>simple-binding-name</b>。<br />例如:<br /><pre class="brush: xml">&lt;core:init <br />    jndi-pattern=&quot;ejblocal:myModule/#{ejbName}&quot; <br />    debug=&quot;false&quot; /&gt;<br /></pre><br /><b>simple-binding-name</b> 亦要更改為:<br /><pre class="brush: xml">&lt;session name=&quot;MyBean&quot; <br />    simple-binding-name=&quot;MyModule/myBean&quot; /&gt;<br /></pre><br />相關書籍: <a imageanchor="1" target="_blank"  href="http://www.amazon.com/Seam-Action-Dan-Allen/dp/1933988401?ie=UTF8&tag=program06-20&link_code=bil&camp=213689&creative=392969"><img alt="Seam in Action" src="http://ws.amazon.com/widgets/q?MarketPlace=US&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL160_&ASIN=1933988401&tag=program06-20" /></a><img src="http://www.assoc-amazon.com/e/ir?t=program06-20&l=bil&camp=213689&creative=392969&o=1&a=1933988401" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important; padding: 0px !important" /><a imageanchor="1" target="_blank"  href="http://www.amazon.com/Seam-Framework-Experience-Evolution-Java/dp/0137129394?ie=UTF8&tag=program06-20&link_code=bil&camp=213689&creative=392969"><img alt="Seam Framework: Experience the Evolution of Java EE (2nd Edition)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL160_&ASIN=0137129394&tag=program06-20" /></a><img src="http://www.assoc-amazon.com/e/ir?t=program06-20&l=bil&camp=213689&creative=392969&o=1&a=0137129394" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important; padding: 0px !important" /><a imageanchor="1" target="_blank"  href="http://www.amazon.com/WebSphere-Application-Server-Internals-Professionals/dp/1430219580?ie=UTF8&tag=program06-20&link_code=bil&camp=213689&creative=392969"><img alt="Pro IBM WebSphere Application Server 7 Internals (Books for Professionals by Professionals)" src="http://ws.amazon.com/widgets/q?MarketPlace=US&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL160_&ASIN=1430219580&tag=program06-20" /></a><img src="http://www.assoc-amazon.com/e/ir?t=program06-20&l=bil&camp=213689&creative=392969&o=1&a=1430219580" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important; padding: 0px !important" /><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5998578522192555089-7344194767850097008?l=lawpronotes.blogspot.com' alt='' /></div></p>
]]></content>
  </entry>
  
</feed>
